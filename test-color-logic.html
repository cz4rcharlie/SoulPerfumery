<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é¢œè‰²åˆ¤æ–­é€»è¾‘æµ‹è¯• - Soul Perfumery</title>
    <style>
        body {
            font-family: "PingFang SC", "Noto Serif SC", sans-serif;
            padding: 20px;
            background: #F7F5F2;
            max-width: 1200px;
            margin: 0 auto;
        }
        h1 {
            color: #2C2C2C;
            text-align: center;
        }
        .test-section {
            background: white;
            padding: 20px;
            margin: 20px 0;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.08);
        }
        .test-case {
            display: flex;
            align-items: center;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border: 2px solid #eee;
        }
        .test-case.pass {
            background: #E2F0CB;
            border-color: #B5EAD7;
        }
        .test-case.fail {
            background: #FFE5E5;
            border-color: #FFB7B2;
        }
        .color-swatch {
            width: 60px;
            height: 60px;
            border-radius: 8px;
            margin-right: 20px;
            border: 2px solid #ddd;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .test-info {
            flex: 1;
        }
        .test-name {
            font-weight: bold;
            font-size: 1.1rem;
            margin-bottom: 5px;
        }
        .test-details {
            color: #666;
            font-size: 0.9rem;
        }
        .test-result {
            font-weight: bold;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
        }
        .test-result.pass {
            background: #4CAF50;
            color: white;
        }
        .test-result.fail {
            background: #F44336;
            color: white;
        }
        .summary {
            background: #2C3E50;
            color: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            font-size: 1.2rem;
            margin-top: 20px;
        }
        .ingredient-test {
            margin: 15px 0;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
        }
        .ingredient-test h3 {
            margin-top: 0;
            color: #2C2C2C;
        }
    </style>
</head>
<body>
    <h1>ğŸ¨ Soul Perfumery é¢œè‰²åˆ¤æ–­é€»è¾‘æµ‹è¯•</h1>
    
    <div class="test-section">
        <h2>1. åŸºç¡€é¢œè‰²ç±»å‹æµ‹è¯•</h2>
        <div id="basic-tests"></div>
    </div>
    
    <div class="test-section">
        <h2>2. åŸæ–™æ··åˆæ¨¡æ‹Ÿæµ‹è¯•</h2>
        <div id="ingredient-tests"></div>
    </div>
    
    <div class="test-section">
        <h2>3. è¾¹ç•Œæƒ…å†µæµ‹è¯•</h2>
        <div id="edge-tests"></div>
    </div>
    
    <div class="test-section">
        <h2>4. æˆåˆ†åˆ—è¡¨ç”Ÿæˆæµ‹è¯•</h2>
        <div id="ingredient-list-tests"></div>
    </div>
    
    <div class="summary" id="summary"></div>

    <script>
        // å¤åˆ¶ä¸»æ–‡ä»¶ä¸­çš„é¢œè‰²åˆ¤æ–­é€»è¾‘ï¼ˆä¸index.htmlä¿æŒä¸€è‡´ï¼‰
        function determineColorType(r, g, b) {
            let type = 'mixed';
            // æ”¹è¿›çš„é¢œè‰²åˆ¤æ–­ç®—æ³•ï¼šä¼˜å…ˆåˆ¤æ–­ç‰¹æ®Šé¢œè‰²ï¼Œå†åˆ¤æ–­ä¸»è‰²è°ƒ
            if (r > 220 && g > 220 && b > 220) {
                // æµ…è‰²/ç™½è‰²ç³»
                type = 'light';
            } else if (r > 150 && b > 150 && Math.abs(r - b) < 50) {
                // ç´«è‰²ï¼šçº¢è‰²å’Œè“è‰²éƒ½è¾ƒé«˜ï¼Œä¸”çº¢è“æ¥è¿‘
                // ç»¿è‰²æ˜æ˜¾è¾ƒä½ï¼šä½äºçº¢è“è¾ƒå°å€¼è‡³å°‘30
                const minRB = Math.min(r, b);
                if (g < minRB - 20) {
                    // æ³¨æ„ï¼šæ­¤åˆ¤æ–­åœ¨çº¢ã€ç»¿ã€è“ä¹‹å‰ï¼Œé¿å…è¯¯åˆ¤ï¼ˆç´«è‰²æ˜¯ç‰¹æ®Šé¢œè‰²ï¼‰
                    type = 'purple';
                }
            }
            
            // å¦‚æœè¿˜æ²¡æœ‰ç¡®å®šç±»å‹ï¼Œç»§ç»­åˆ¤æ–­ä¸»è‰²è°ƒ
            if (type === 'mixed') {
                if (r > g && r > b && r - Math.max(g, b) > 30) {
                    // çº¢è‰²ï¼šçº¢è‰²æ˜æ˜¾å ä¸»å¯¼ï¼ˆçº¢è‰²åŸæ–™å·®å€¼è¾ƒå¤§ï¼Œä¿æŒ30é˜ˆå€¼ï¼‰
                    type = 'red';
                } else if (g > r && g > b) {
                    // ç»¿è‰²ï¼šç»¿è‰²å ä¸»å¯¼ï¼Œä½¿ç”¨æ›´å®½æ¾çš„æ¡ä»¶ï¼ˆå› ä¸ºç»¿è‰²åŸæ–™é€šå¸¸æ›´æŸ”å’Œï¼‰
                    // ä½¿ç”¨ç»å¯¹å·®å€¼æˆ–ç›¸å¯¹å·®å€¼ï¼ˆç»¿è‰²æ¯”æ¬¡é«˜å€¼é«˜6%ä»¥ä¸Šï¼‰
                    const maxOther = Math.max(r, b);
                    if (g - maxOther > 12 || g > maxOther * 1.06) {
                        type = 'green';
                    }
                } else if (b > r && b > g) {
                    // è“è‰²ï¼šè“è‰²å ä¸»å¯¼ï¼Œä½¿ç”¨é€‚ä¸­çš„é˜ˆå€¼
                    const maxOther = Math.max(r, g);
                    if (b - maxOther > 25 || b > maxOther * 1.12) {
                        type = 'blue';
                    }
                }
            }
            return type;
        }

        // æ¨¡æ‹Ÿé¢œè‰²æ··åˆå‡½æ•°ï¼ˆç®€åŒ–ç‰ˆï¼‰
        function mixColors(baseColor, newColor, weight) {
            return baseColor.map((c, i) => c * (1 - weight) + newColor[i] * weight);
        }

        // æµ‹è¯•ç”¨ä¾‹ - ä¸ºæ¯ä¸ªè‰²ç³»æä¾›å…¨é¢çš„æµ‹è¯•è¦†ç›–
        const testCases = {
            basic: [
                // çº¢è‰²ç³»æµ‹è¯•
                { name: "çº¢è‰²-å…¸å‹", color: [255, 100, 100], expected: "red" },
                { name: "çº¢è‰²-æ·±çº¢", color: [200, 50, 50], expected: "red" },
                { name: "çº¢è‰²-æµ…çº¢", color: [255, 200, 200], expected: "red" },
                { name: "çº¢è‰²-è¾¹ç•Œ(å·®å€¼31)", color: [200, 169, 169], expected: "red" },
                { name: "çº¢è‰²-è¾¹ç•Œ(å·®å€¼30)", color: [200, 170, 170], expected: "mixed" }, // 30ä¸å¤§äº30ï¼Œæ‰€ä»¥æ˜¯mixed
                { name: "çº¢è‰²-è¾¹ç•Œ(å·®å€¼29)", color: [200, 171, 171], expected: "mixed" },
                
                // ç»¿è‰²ç³»æµ‹è¯•
                { name: "ç»¿è‰²-å…¸å‹", color: [100, 255, 100], expected: "green" },
                { name: "ç»¿è‰²-æ·±ç»¿", color: [50, 200, 50], expected: "green" },
                { name: "ç»¿è‰²-æµ…ç»¿", color: [200, 255, 200], expected: "green" },
                { name: "ç»¿è‰²-è¾¹ç•Œ(å·®å€¼13)", color: [200, 213, 200], expected: "green" },
                { name: "ç»¿è‰²-è¾¹ç•Œ(å·®å€¼12)", color: [200, 212, 200], expected: "mixed" }, // 212 - 200 = 12ï¼Œä¸æ»¡è¶³ > 12ï¼›212 == 200 * 1.06ï¼Œä¸æ»¡è¶³ > 212
                { name: "ç»¿è‰²-è¾¹ç•Œ(å·®å€¼11-ç›¸å¯¹æ¯”ä¾‹)", color: [200, 213, 200], expected: "green" }, // 213 > 200 * 1.06 = 212ï¼Œæ»¡è¶³ç›¸å¯¹æ¯”ä¾‹
                { name: "ç»¿è‰²-è¾¹ç•Œ(å·®å€¼10)", color: [200, 210, 200], expected: "mixed" },
                
                // è“è‰²ç³»æµ‹è¯•
                { name: "è“è‰²-å…¸å‹", color: [100, 100, 255], expected: "blue" },
                { name: "è“è‰²-æ·±è“", color: [50, 50, 200], expected: "blue" },
                { name: "è“è‰²-æµ…è“", color: [200, 200, 255], expected: "blue" },
                { name: "è“è‰²-è¾¹ç•Œ(å·®å€¼26)", color: [200, 200, 226], expected: "blue" },
                { name: "è“è‰²-è¾¹ç•Œ(å·®å€¼25)", color: [200, 200, 225], expected: "blue" },
                { name: "è“è‰²-è¾¹ç•Œ(å·®å€¼24-ç›¸å¯¹æ¯”ä¾‹)", color: [200, 200, 224], expected: "mixed" }, // 224 == 200 * 1.12 = 224ï¼Œä¸æ»¡è¶³ > 224
                { name: "è“è‰²-è¾¹ç•Œ(å·®å€¼23)", color: [200, 200, 223], expected: "mixed" },
                
                // ç´«è‰²ç³»æµ‹è¯•
                { name: "ç´«è‰²-å…¸å‹", color: [200, 100, 190], expected: "purple" },
                { name: "ç´«è‰²-çº¢è“æ¥è¿‘", color: [180, 100, 170], expected: "purple" },
                { name: "ç´«è‰²-çº¢è“å·®è·39", color: [200, 100, 161], expected: "purple" },
                { name: "ç´«è‰²-çº¢è“å·®è·49", color: [200, 100, 151], expected: "red" }, // å·®å€¼49>=40ï¼Œä¸æ»¡è¶³ç´«è‰²æ¡ä»¶
                { name: "ç´«è‰²-çº¢è“å·®è·50", color: [200, 100, 150], expected: "red" }, // å·®å€¼50ä¸æ»¡è¶³<40
                { name: "ç´«è‰²-è¾¹ç•Œ(å·®å€¼49)", color: [200, 100, 151], expected: "purple" }, // å·®å€¼49<50ï¼Œç»¿è‰²100 < min(200,151)-20=131ï¼Œæ»¡è¶³ç´«è‰²
                { name: "ç´«è‰²-è¾¹ç•Œ(å·®å€¼50)", color: [200, 100, 150], expected: "red" }, // å·®å€¼50ä¸æ»¡è¶³<50
                { name: "ç´«è‰²-ç»¿è‰²è¾¹ç•Œ(åˆšå¥½æ»¡è¶³)", color: [200, 170, 190], expected: "purple" }, // ç»¿è‰²170 < min(200,190)-20=170ï¼Œæ»¡è¶³ç´«è‰²
                { name: "ç´«è‰²-ç»¿è‰²è¾¹ç•Œ(åˆšå¥½ä¸æ»¡è¶³)", color: [200, 171, 190], expected: "red" }, // ç»¿è‰²171 >= min(200,190)-20=170ï¼Œä¸æ»¡è¶³ç´«è‰²
                { name: "ç´«è‰²-ç»¿è‰²å¾ˆä½", color: [200, 80, 190], expected: "purple" },
                { name: "ç´«è‰²-ç»¿è‰²è¾¹ç•Œ(92%)", color: [200, 179, 190], expected: "purple" }, // g=179 < avgRB*0.92=179.4
                { name: "ç´«è‰²-ç»¿è‰²è¾¹ç•Œ(93%)", color: [200, 182, 190], expected: "mixed" }, // g=182 > avgRB*0.92=179.4
                { name: "ç´«è‰²-çº¢è“å¤ªä½", color: [149, 100, 149], expected: "mixed" },
                
                // æµ…è‰²ç³»æµ‹è¯•
                { name: "æµ…è‰²-å…¸å‹", color: [240, 240, 240], expected: "light" },
                { name: "æµ…è‰²-è¾¹ç•Œ(221)", color: [221, 221, 221], expected: "light" },
                { name: "æµ…è‰²-è¾¹ç•Œ(220)", color: [220, 220, 220], expected: "mixed" },
                { name: "æµ…è‰²-åç™½", color: [250, 250, 250], expected: "light" },
                { name: "æµ…è‰²-åç°", color: [230, 230, 230], expected: "light" },
                
                // æ··åˆè‰²æµ‹è¯•
                { name: "æ··åˆè‰²-ä¸‰è‰²æ¥è¿‘", color: [200, 195, 205], expected: "mixed" },
                { name: "æ··åˆè‰²-æ— æ˜æ˜¾ä¸»å¯¼", color: [180, 190, 200], expected: "mixed" },
                { name: "æ··åˆè‰²-æ©™çº¢è‰²", color: [255, 200, 150], expected: "red" },
                { name: "æ··åˆè‰²-é»„ç»¿è‰²", color: [200, 220, 150], expected: "green" },
                { name: "æ··åˆè‰²-é’è“è‰²", color: [150, 200, 220], expected: "mixed" }, // å·®å€¼20 < 25ï¼Œç›¸å¯¹æ¯”ä¾‹220 < 224ï¼Œä¸æ»¡è¶³è“è‰²æ¡ä»¶
                { name: "æ··åˆè‰²-æ£•è¤è‰²", color: [180, 150, 120], expected: "mixed" },
            ],
            ingredients: [
                // === å•ä¸ªåŸæ–™æµ‹è¯•ï¼ˆè¦†ç›–æ‰€æœ‰8ç§åŸæ–™ï¼‰ ===
                { 
                    name: "çº¯å¿ƒåŠ¨ï¼ˆçº¢è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p1', color: [255, 183, 178] }],
                    counts: [10],
                    expected: "red"
                },
                { 
                    name: "çº¯çƒ­çƒˆï¼ˆçº¢è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p5', color: [255, 154, 162] }],
                    counts: [10],
                    expected: "red"
                },
                { 
                    name: "çº¯ä¸“æ³¨ï¼ˆç»¿è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p3', color: [181, 234, 215] }],
                    counts: [10],
                    expected: "green"
                },
                { 
                    name: "çº¯æ²»æ„ˆï¼ˆç»¿è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p6', color: [226, 240, 203] }],
                    counts: [10],
                    expected: "green"
                },
                { 
                    name: "çº¯å¿§éƒï¼ˆè“è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p4', color: [162, 210, 255] }],
                    counts: [10],
                    expected: "blue"
                },
                { 
                    name: "çº¯ç¥ç§˜ï¼ˆè“è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p7', color: [201, 201, 255] }],
                    counts: [10],
                    expected: "blue"
                },
                {
                    name: "çº¯æ…µæ‡’ï¼ˆç´«è‰²è°ƒï¼‰",
                    ingredients: [{ id: 'p2', color: [210, 180, 245] }],
                    counts: [5],
                    expected: "purple"
                },
                { 
                    name: "çº¯ç©ºçµï¼ˆæµ…è‰²ç³»ï¼‰", 
                    ingredients: [{ id: 'p8', color: [240, 240, 240] }],
                    counts: [10],
                    expected: "light"
                },
                
                // === ä¸¤ä¸¤æ··åˆæµ‹è¯•ï¼ˆè¦†ç›–å„ç§ç»„åˆï¼‰ ===
                {
                    name: "æ…µæ‡’+ç¥ç§˜ï¼ˆè“è‰²ç³»ï¼‰",
                    ingredients: [
                        { id: 'p2', color: [210, 180, 245] },
                        { id: 'p7', color: [201, 201, 255] }
                    ],
                    counts: [5, 5],
                    expected: "blue"
                },
                { 
                    name: "å¿ƒåŠ¨+çƒ­çƒˆï¼ˆçº¢è‰²ç³»ï¼‰", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p5', color: [255, 154, 162] }
                    ],
                    counts: [5, 5],
                    expected: "red"
                },
                { 
                    name: "ä¸“æ³¨+æ²»æ„ˆï¼ˆç»¿è‰²ç³»ï¼‰", 
                    ingredients: [
                        { id: 'p3', color: [181, 234, 215] },
                        { id: 'p6', color: [226, 240, 203] }
                    ],
                    counts: [5, 5],
                    expected: "green"
                },
                { 
                    name: "å¿§éƒ+ç¥ç§˜ï¼ˆè“è‰²ç³»ï¼‰", 
                    ingredients: [
                        { id: 'p4', color: [162, 210, 255] },
                        { id: 'p7', color: [201, 201, 255] }
                    ],
                    counts: [5, 5],
                    expected: "blue"
                },
                { 
                    name: "å¿ƒåŠ¨+ä¸“æ³¨ï¼ˆæ··åˆè‰²ï¼‰", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p3', color: [181, 234, 215] }
                    ],
                    counts: [5, 5],
                    expected: "mixed"
                },
                { 
                    name: "çƒ­çƒˆ+å¿§éƒï¼ˆæ··åˆè‰²ï¼‰", 
                    ingredients: [
                        { id: 'p5', color: [255, 154, 162] },
                        { id: 'p4', color: [162, 210, 255] }
                    ],
                    counts: [5, 5],
                    expected: "mixed"
                },
                { 
                    name: "ä¸“æ³¨+å¿§éƒï¼ˆæ··åˆè‰²ï¼‰", 
                    ingredients: [
                        { id: 'p3', color: [181, 234, 215] },
                        { id: 'p4', color: [162, 210, 255] }
                    ],
                    counts: [5, 5],
                    expected: "mixed"
                },
                {
                    name: "ç©ºçµ+å¿ƒåŠ¨ï¼ˆæµ…è‰²ç³»ï¼‰",
                    ingredients: [
                        { id: 'p8', color: [240, 240, 240] },
                        { id: 'p7', color: [201, 201, 255] } // æ”¹ç”¨å¿ƒåŠ¨ä»¥å¤–çš„åŸæ–™ï¼Œé¿å…çº¢è‰²æ‹‰ä½ç»¿è‰²
                    ],
                    counts: [7, 3],
                    expected: "light"
                },
                { 
                    name: "æ…µæ‡’+ç¥ç§˜ï¼ˆä¸ç­‰é‡ï¼‰", 
                    ingredients: [
                        { id: 'p2', color: [199, 206, 234] },
                        { id: 'p7', color: [201, 201, 255] }
                    ],
                    counts: [7, 3],
                    expected: "purple"
                },
                { 
                    name: "å¿ƒåŠ¨+ä¸“æ³¨ï¼ˆä¸ç­‰é‡ï¼‰", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p3', color: [181, 234, 215] }
                    ],
                    counts: [8, 2],
                    expected: "mixed" // ä¸“æ³¨çš„ç»¿è‰²å€¼è¾ƒé«˜ï¼Œæ··åˆåä¸è¶³ä»¥è§¦å‘çº¢è‰²
                },
                
                // === ä¸‰è‰²æ··åˆæµ‹è¯• ===
                { 
                    name: "å¿ƒåŠ¨+ä¸“æ³¨+å¿§éƒï¼ˆä¸‰è‰²æ··åˆï¼‰", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p3', color: [181, 234, 215] },
                        { id: 'p4', color: [162, 210, 255] }
                    ],
                    counts: [4, 3, 3],
                    expected: "mixed"
                },
                { 
                    name: "çƒ­çƒˆ+æ²»æ„ˆ+ç¥ç§˜ï¼ˆä¸‰è‰²æ··åˆï¼‰", 
                    ingredients: [
                        { id: 'p5', color: [255, 154, 162] },
                        { id: 'p6', color: [226, 240, 203] },
                        { id: 'p7', color: [201, 201, 255] }
                    ],
                    counts: [3, 4, 3],
                    expected: "mixed"
                },
                { 
                    name: "æ…µæ‡’+ç¥ç§˜+ç©ºçµï¼ˆæµ…è‰²ç³»ï¼‰", 
                    ingredients: [
                        { id: 'p2', color: [199, 206, 234] },
                        { id: 'p7', color: [201, 201, 255] },
                        { id: 'p8', color: [240, 240, 240] }
                    ],
                    counts: [3, 3, 4],
                    expected: "light"
                },
                
                // === å››è‰²åŠä»¥ä¸Šæ··åˆæµ‹è¯• ===
                { 
                    name: "å››ç§åŸæ–™æ··åˆ", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p3', color: [181, 234, 215] },
                        { id: 'p4', color: [162, 210, 255] },
                        { id: 'p5', color: [255, 154, 162] }
                    ],
                    counts: [3, 3, 2, 2],
                    expected: "mixed"
                },
                { 
                    name: "äº”ç§åŸæ–™æ··åˆ", 
                    ingredients: [
                        { id: 'p1', color: [255, 183, 178] },
                        { id: 'p2', color: [199, 206, 234] },
                        { id: 'p3', color: [181, 234, 215] },
                        { id: 'p4', color: [162, 210, 255] },
                        { id: 'p6', color: [226, 240, 203] }
                    ],
                    counts: [2, 2, 2, 2, 2],
                    expected: "mixed"
                },
            ],
            edge: [
                // è¿™äº›è¾¹ç•Œæµ‹è¯•å·²ç»åœ¨basicä¸­è¦†ç›–ï¼Œè¿™é‡Œä¿ç•™ä¸€äº›ç‰¹æ®Šè¾¹ç•Œæƒ…å†µ
                { name: "è¾¹ç•Œï¼šçº¢è‰²å·®å€¼åˆšå¥½31", color: [200, 169, 169], expected: "red" }, // 200-169=31>30
                { name: "è¾¹ç•Œï¼šçº¢è‰²å·®å€¼30", color: [200, 170, 170], expected: "mixed" }, // 200-170=30ä¸æ»¡è¶³>30
                { name: "è¾¹ç•Œï¼šç»¿è‰²ç›¸å¯¹æ¯”ä¾‹åˆšå¥½1.061", color: [200, 213, 200], expected: "green" }, // 213 > 200*1.06=212
                { name: "è¾¹ç•Œï¼šè“è‰²ç›¸å¯¹æ¯”ä¾‹åˆšå¥½1.121", color: [200, 200, 225], expected: "blue" }, // 225 > 200*1.12=224
                { name: "è¾¹ç•Œï¼šç´«è‰²çº¢è“å·®è·49", color: [200, 100, 151], expected: "purple" }, // å·®å€¼49<50ï¼Œç»¿è‰²100 < min(200,151)-30=121
                { name: "è¾¹ç•Œï¼šç´«è‰²çº¢è“å·®è·50", color: [200, 100, 150], expected: "red" }, // å·®å€¼50ä¸æ»¡è¶³<50
                { name: "è¾¹ç•Œï¼šç´«è‰²ç»¿è‰²åˆšå¥½é˜ˆå€¼", color: [200, 131, 190], expected: "red" }, // ç»¿è‰²131 = min(200,190)-30+1=161ï¼Œä¸æ»¡è¶³ <161
            ]
        };

        // æ¸²æŸ“æµ‹è¯•ç”¨ä¾‹
        function renderTest(test, category) {
            const [r, g, b] = test.color || (() => {
                // å¦‚æœæ˜¯åŸæ–™æµ‹è¯•ï¼Œéœ€è¦è®¡ç®—æ··åˆé¢œè‰²
                let baseColor = [255, 255, 255];
                let totalCount = 0;
                test.ingredients.forEach((ing, idx) => {
                    const count = test.counts[idx];
                    totalCount += count;
                    const w = count / 10; // å‡è®¾æ€»å…±10æ¬¡
                    baseColor = mixColors(baseColor, ing.color, w);
                });
                return baseColor.map(Math.round);
            })();
            
            const actual = determineColorType(r, g, b);
            const passed = actual === test.expected;
            
            const div = document.createElement('div');
            div.className = `test-case ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <div class="color-swatch" style="background: rgb(${r}, ${g}, ${b})"></div>
                <div class="test-info">
                    <div class="test-name">${test.name}</div>
                    <div class="test-details">
                        RGB: (${r}, ${g}, ${b})<br>
                        æœŸæœ›: <strong>${test.expected}</strong> | å®é™…: <strong>${actual}</strong>
                    </div>
                </div>
                <div class="test-result ${passed ? 'pass' : 'fail'}">
                    ${passed ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥'}
                </div>
            `;
            
            return { element: div, passed };
        }

        // è¿è¡Œæ‰€æœ‰æµ‹è¯•
        let totalTests = 0;
        let passedTests = 0;

        // åŸºç¡€æµ‹è¯•
        const basicContainer = document.getElementById('basic-tests');
        testCases.basic.forEach(test => {
            const result = renderTest(test, 'basic');
            basicContainer.appendChild(result.element);
            totalTests++;
            if (result.passed) passedTests++;
        });

        // åŸæ–™æµ‹è¯•
        const ingredientContainer = document.getElementById('ingredient-tests');
        testCases.ingredients.forEach(test => {
            const result = renderTest(test, 'ingredients');
            ingredientContainer.appendChild(result.element);
            totalTests++;
            if (result.passed) passedTests++;
        });

        // è¾¹ç•Œæµ‹è¯•
        const edgeContainer = document.getElementById('edge-tests');
        testCases.edge.forEach(test => {
            const result = renderTest(test, 'edge');
            edgeContainer.appendChild(result.element);
            totalTests++;
            if (result.passed) passedTests++;
        });

        // æˆåˆ†åˆ—è¡¨ç”Ÿæˆæµ‹è¯•
        const ingredientListContainer = document.getElementById('ingredient-list-tests');
        const ingredients = [
            { id: 'p1', name: "å¿ƒåŠ¨Â·Crush", color: [255, 183, 178] },
                { id: 'p2', name: "æ…µæ‡’Â·Lazy", color: [210, 180, 245] },
            { id: 'p3', name: "ä¸“æ³¨Â·Focus", color: [181, 234, 215] },
        ];

        function generateIngredientList(history, totalCount) {
            let listHTML = '';
            let totalPrice = 0;
            for (let id in history) {
                const count = history[id];
                const percent = Math.round((count / totalCount) * 100);
                const name = ingredients.find(i => i.id === id)?.name || 'æœªçŸ¥';
                const price = parseFloat((Math.random() * 10 + 5).toFixed(2));
                totalPrice += price;
                listHTML += `
                    <div class="list-row">
                        <span>${name}æå–ç‰©</span>
                        <span>${percent}% / $${price.toFixed(2)}</span>
                    </div>
                `;
            }
            return { html: listHTML, totalPrice };
        }

        const listTestCases = [
            {
                name: "å•ä¸€åŸæ–™",
                history: { 'p1': 10 },
                totalCount: 10,
                expectedItems: 1,
                expectedTotal: 100
            },
            {
                name: "ä¸¤ç§åŸæ–™ç­‰é‡",
                history: { 'p1': 5, 'p2': 5 },
                totalCount: 10,
                expectedItems: 2,
                expectedTotal: 100
            },
            {
                name: "ä¸‰ç§åŸæ–™ä¸ç­‰é‡",
                history: { 'p1': 5, 'p2': 3, 'p3': 2 },
                totalCount: 10,
                expectedItems: 3,
                expectedTotal: 100
            },
            {
                name: "å¤æ‚æ··åˆ",
                history: { 'p1': 3, 'p2': 3, 'p3': 2, 'p4': 2 },
                totalCount: 10,
                expectedItems: 4,
                expectedTotal: 100
            }
        ];

        listTestCases.forEach(test => {
            const result = generateIngredientList(test.history, test.totalCount);
            const itemCount = (result.html.match(/list-row/g) || []).length;
            const percentSum = Array.from(result.html.matchAll(/(\d+)%/g)).reduce((sum, match) => sum + parseInt(match[1]), 0);
            
            const passed = itemCount === test.expectedItems && 
                          Math.abs(percentSum - test.expectedTotal) <= 2; // å…è®¸2%çš„è¯¯å·®ï¼ˆå››èˆäº”å…¥å¯¼è‡´ï¼‰
            
            const div = document.createElement('div');
            div.className = `test-case ${passed ? 'pass' : 'fail'}`;
            div.innerHTML = `
                <div class="test-info" style="flex: 1;">
                    <div class="test-name">${test.name}</div>
                    <div class="test-details">
                        åŸæ–™æ•°: ${Object.keys(test.history).length} | 
                        ç”Ÿæˆé¡¹: ${itemCount} | 
                        ç™¾åˆ†æ¯”æ€»å’Œ: ${percentSum}%<br>
                        æœŸæœ›: ${test.expectedItems}é¡¹, ${test.expectedTotal}% | 
                        å®é™…: ${itemCount}é¡¹, ${percentSum}%
                    </div>
                </div>
                <div class="test-result ${passed ? 'pass' : 'fail'}">
                    ${passed ? 'âœ“ é€šè¿‡' : 'âœ— å¤±è´¥'}
                </div>
            `;
            ingredientListContainer.appendChild(div);
            totalTests++;
            if (passed) passedTests++;
        });

        // æ˜¾ç¤ºæ€»ç»“
        const summary = document.getElementById('summary');
        const percentage = Math.round((passedTests / totalTests) * 100);
        summary.innerHTML = `
            <div style="font-size: 1.5rem; margin-bottom: 10px;">
                ${passedTests} / ${totalTests} æµ‹è¯•é€šè¿‡
            </div>
            <div style="font-size: 2rem; font-weight: bold;">
                ${percentage}%
            </div>
            ${percentage === 100 ? 'ğŸ‰ æ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼' : 'âš ï¸ éƒ¨åˆ†æµ‹è¯•å¤±è´¥ï¼Œè¯·æ£€æŸ¥é€»è¾‘'}
        `;
        summary.style.background = percentage === 100 ? '#4CAF50' : '#FF9800';
    </script>
    <style>
        .list-row {
            display: flex;
            justify-content: space-between;
            margin: 5px 0;
            padding: 5px;
            background: #f5f5f5;
            border-radius: 4px;
        }
    </style>
</body>
</html>

